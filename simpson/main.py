import time

import requests
from bs4 import BeautifulSoup

# 문제 아이디 받아는 부분 (크롤링 기술)
ses = requests.Session()
res = ses.get("http://www.esimson.com/exam/MoGiSa_Start.aspx?mpidx={0}&examidx={1}&ex1=0".format(mpidx, examidx))
soup = BeautifulSoup(res.text, 'html.parser')

munjae_idxs = soup.select('.answer')

parsed_munjae_idxs = []
for munjae_idx in munjae_idxs:
    if not (munjae_idx['onclick'].split("SetAnswerDam(")[1].split(",")[0] in parsed_munjae_idxs):
        parsed_munjae_idxs.append(munjae_idx['onclick'].split("SetAnswerDam(")[1].split(",")[0])
##########
# 정답 바꾸는 부분
before_answer = []
answer = [1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, 2,
          3, 4, 5, 1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, 2, 3, 4,
          5]
idx = 0
for munjae_idx in parsed_munjae_idxs:
    res = ses.post('http://www.esimson.com/exam/ajax.aspx', data={
        "mpidx": mpidx,
        "examidx": examidx,
        "munjaeidx": munjae_idx,
        "async": "true",
        "answer": answer[idx],
        "gubun": 2
    })
    idx += 1
    print(res.text)

#결과 값 가져오는 부분
res = ses.get("http://www.esimson.com/exam/MogiSa_End.aspx?mpIdx={0}&examIdx={1}&ex1=0".format(mpidx, examidx))
print(res.text)
